
const USERS_NUTRIENT_REQUIRMENTS = {
    "maleReq18": {
        "reqTotalCarbohydrate": 130,
        "reqLinoleicAcid": 17,
        "reqAlphaLinoleicAcid": 1.6,
        "reqProtein": 56,
        "reqDietaryFiber": 38,
        "reqVitA": 900,
        "reqVitD": 15,
        "reqVitE": 15,
        "reqVitK": 120,
        "reqVitC": 90,
        "reqVitB1": 1.2,
        "reqVitB2": 1.3,
        "reqVitB3": 16,
        "reqVitB5": 5,
        "reqVitB6": 1.3,
        "reqVitB9": 400,
        "reqVitB12": 2.4,
        "reqCa": 1000,
        "reqCu": 900,
        "reqFe": 8,
        "reqMg": 400,
        "reqMn": 2.3,
        "reqP": 700,
        "reqSe": 55,
        "reqZn": 11,
        "reqK": 4.7,
        "reqNa": 1.5
    },
    "maleReq31": {
        "reqTotalCarbohydrate": 130,
        "reqLinoleicAcid": 17,
        "reqAlphaLinoleicAcid": 1.6,
        "reqProtein": 56,
        "reqDietaryFiber": 38,
        "reqVitA": 900,
        "reqVitD": 15,
        "reqVitE": 15,
        "reqVitK": 120,
        "reqVitC": 90,
        "reqVitB1": 1.2,
        "reqVitB2": 1.3,
        "reqVitB3": 16,
        "reqVitB5": 5,
        "reqVitB6": 1.3,
        "reqVitB9": 400,
        "reqVitB12": 2.4,
        "reqCa": 1000,
        "reqCu": 900,
        "reqFe": 8,
        "reqMg": 420,
        "reqMn": 2.3,
        "reqP": 700,
        "reqSe": 55,
        "reqZn": 11,
        "reqK": 4.7,
        "reqNa": 1.5
    },
    "maleReq51": {
        "reqTotalCarbohydrate": 130,
        "reqLinoleicAcid": 14,
        "reqAlphaLinoleicAcid": 1.6,
        "reqProtein": 56,
        "reqDietaryFiber": 30,
        "reqVitA": 900,
        "reqVitD": 15,
        "reqVitE": 15,
        "reqVitK": 120,
        "reqVitC": 90,
        "reqVitB1": 1.2,
        "reqVitB2": 1.3,
        "reqVitB3": 16,
        "reqVitB5": 5,
        "reqVitB6": 1.7,
        "reqVitB9": 400,
        "reqVitB12": 2.4,
        "reqCa": 1000,
        "reqCu": 900,
        "reqFe": 8,
        "reqMg": 420,
        "reqMn": 2.3,
        "reqP": 700,
        "reqSe": 55,
        "reqZn": 11,
        "reqK": 4.7,
        "reqNa": 1.3
    },
    "maleReq71": {
        "reqTotalCarbohydrate": 130,
        "reqLinoleicAcid": 14,
        "reqAlphaLinoleicAcid": 1.6,
        "reqProtein": 56,
        "reqDietaryFiber": 30,
        "reqVitA": 900,
        "reqVitD": 20,
        "reqVitE": 15,
        "reqVitK": 120,
        "reqVitC": 90,
        "reqVitB1": 1.2,
        "reqVitB2": 1.3,
        "reqVitB3": 16,
        "reqVitB5": 5,
        "reqVitB6": 1.7,
        "reqVitB9": 400,
        "reqVitB12": 2.4,
        "reqCa": 1200,
        "reqCu": 900,
        "reqFe": 8,
        "reqMg": 420,
        "reqMn": 2.3,
        "reqP": 700,
        "reqSe": 55,
        "reqZn": 11,
        "reqK": 4.7,
        "reqNa": 1.2
    },                                                        
    "femaleReq18": {
        "reqTotalCarbohydrate": 130,
        "reqLinoleicAcid": 12,
        "reqAlphaLinoleicAcid": 1.1,
        "reqProtein": 46,
        "reqDietaryFiber": 25,
        "reqVitA": 700,
        "reqVitD": 15,
        "reqVitE": 15,
        "reqVitK": 90,
        "reqVitC": 75,
        "reqVitB1": 1.1,
        "reqVitB2": 1.1,
        "reqVitB3": 14,
        "reqVitB5": 5,
        "reqVitB6": 1.3,
        "reqVitB9": 400,
        "reqVitB12": 2.4,
        "reqCa": 1000,
        "reqCu": 900,
        "reqFe": 18,
        "reqMg": 310,
        "reqMn": 1.8,
        "reqP": 700,
        "reqSe": 55,
        "reqZn": 8,
        "reqK": 4.7,
        "reqNa": 1.5
    },
    "femaleReq31": {
        "reqTotalCarbohydrate": 130,
        "reqLinoleicAcid": 12,
        "reqAlphaLinoleicAcid": 1.1,
        "reqProtein": 46,
        "reqDietaryFiber": 25,
        "reqVitA": 700,
        "reqVitD": 15,
        "reqVitE": 15,
        "reqVitK": 90,
        "reqVitC": 75,
        "reqVitB1": 1.1,
        "reqVitB2": 1.1,
        "reqVitB3": 14,
        "reqVitB5": 5,
        "reqVitB6": 1.3,
        "reqVitB9": 400,
        "reqVitB12": 2.4,
        "reqCa": 1000,
        "reqCu": 900,
        "reqFe": 18,
        "reqMg": 320,
        "reqMn": 1.8,
        "reqP": 700,
        "reqSe": 55,
        "reqZn": 8,
        "reqK": 4.7,
        "reqNa": 1.5
    },
    "femaleReq51": {
        "reqTotalCarbohydrate": 130,
        "reqLinoleicAcid": 11,
        "reqAlphaLinoleicAcid": 1.1,
        "reqProtein": 46,
        "reqDietaryFiber": 21,
        "reqVitA": 700,
        "reqVitD": 15,
        "reqVitE": 15,
        "reqVitK": 90,
        "reqVitC": 75,
        "reqVitB1": 1.1,
        "reqVitB2": 1.1,
        "reqVitB3": 14,
        "reqVitB5": 5,
        "reqVitB6": 1.5,
        "reqVitB9": 400,
        "reqVitB12": 2.4,
        "reqCa": 1200,
        "reqCu": 900,
        "reqFe": 8,
        "reqMg": 320,
        "reqMn": 1.8,
        "reqP": 700,
        "reqSe": 55,
        "reqZn": 8,
        "reqK": 4.7,
        "reqNa": 1.3
    },
    "femaleReq71": {
        "reqTotalCarbohydrate": 130,
        "reqLinoleicAcid": 11,
        "reqAlphaLinoleicAcid": 1.1,
        "reqProtein": 46,
        "reqDietaryFiber": 21,
        "reqVitA": 700,
        "reqVitD": 20,
        "reqVitE": 15,
        "reqVitK": 90,
        "reqVitC": 75,
        "reqVitB1": 1.1,
        "reqVitB2": 1.1,
        "reqVitB3": 14,
        "reqVitB5": 5,
        "reqVitB6": 1.5,
        "reqVitB9": 400,
        "reqVitB12": 2.4,
        "reqCa": 1200,
        "reqCu": 900,
        "reqFe": 8,
        "reqMg": 320,
        "reqMn": 1.8,
        "reqP": 700,
        "reqSe": 55,
        "reqZn": 8,
        "reqK": 4.7,
        "reqNa": 1.2
    },
    "femalePregnant": {
        "reqTotalCarbohydrate": 175,
        "reqLinoleicAcid": 13,
        "reqAlphaLinoleicAcid": 1.4,
        "reqProtein": 71,
        "reqDietaryFiber": 28,
        "reqVitA": 770,
        "reqVitD": 15,
        "reqVitE": 15,
        "reqVitK": 90,
        "reqVitC": 85,
        "reqVitB1": 1.4,
        "reqVitB2": 1.4,
        "reqVitB3": 18,
        "reqVitB5": 6,
        "reqVitB6": 1.9,
        "reqVitB9": 600,
        "reqVitB12": 2.6,
        "reqCa": 1000,
        "reqCu": 1000,
        "reqFe": 27,
        "reqMg": 360,
        "reqMn": 2,
        "reqP": 700,
        "reqSe": 60,
        "reqZn": 11,
        "reqK": 4.7,
        "reqNa": 1.5
    },
    "femaleLactating": {
        "reqTotalCarbohydrate": 210,
        "reqLinoleicAcid": 13,
        "reqAlphaLinoleicAcid": 1.3,
        "reqProtein": 71,
        "reqDietaryFiber": 29,
        "reqVitA": 1300,
        "reqVitD": 15,
        "reqVitE": 15,
        "reqVitK": 90,
        "reqVitC": 120,
        "reqVitB1": 1.4,
        "reqVitB2": 1.6,
        "reqVitB3": 17,
        "reqVitB5": 7,
        "reqVitB6": 2,
        "reqVitB9": 500,
        "reqVitB12": 2.8,
        "reqCa": 1000,
        "reqCu": 1300,
        "reqFe": 9,
        "reqMg": 310,
        "reqMn": 2.6,
        "reqP": 700,
        "reqSe": 70,
        "reqZn": 12,
        "reqK": 5.1,
        "reqNa": 1.5
    }
};

//Creating empty object for user's personal nutrient requirements
let userNutReq = {}; 

//Checking if the required field are filled and moving to the next div
function logIn() {
    
        scrollTo(0,0);
        document.getElementById("divLogIn").style.display = "none";
        document.getElementById("divPersonalInfo").style.display = "block";
       
        document.getElementById("divDailyRequirement").style.display = "none";            
    
}

//If the user is female, show select box, so she can choose if she is pregnant or lactating
function showSelect() {
    let sexValue = document.getElementById("selectSex").value;
    
    if (sexValue === "female") {
        document.getElementById("selectPregnantLactating").style.display = "inline-block";
        document.getElementById("pregnantLactating").style.display = "inline-block";
    }

    else {
        document.getElementById("selectPregnantLactating").style.display = "none";
        document.getElementById("pregnantLactating").style.display = "none";
        document.getElementById("selectPregnantLactating").value = "";
    }
}

//Calculate and present energy requirements and personalized daily nutrient requirements
function calculate() {
    
    let age = document.getElementById("inputAge").value;
    let sex = document.getElementById("selectSex").value;
    let pregnantOrLactating = document.getElementById("selectPregnantLactating").value;
    let height = document.getElementById("inputHeight").value;
    let weight = document.getElementById("inputWeight").value;
    let lifestyle = document.getElementById("selectLifestyle").value;

    //Inicializing activity coeficient (which depend of user's sex) and required calories (which depends of user's age, height, weight, sex, pregnant or lactating and activity)
    let activity = 0;
    let reqCalories = 0;  

    //Checking if the form is filled
    if (age === "" || sex === "") {
        document.getElementById("messageFillIn2").innerHTML = "Please fill in the required fields.";
    }
    
    else if ((height === "" || weight === "") || lifestyle === "") {
        document.getElementById("messageFillIn2").innerHTML = "Please fill in the required fields.";
    }

    else if (age < 18) {
        document.getElementById("messageFillIn2").innerHTML = "This app is not for users under 18 years";    
    }

    //If the form is filled, calculate
    else {   
        scrollTo(0,0);         
        document.getElementById("divPersonalInfo").style.display = "none";
        
        document.getElementById("divDailyRequirement").style.display = "block";
        

        //Calculating calories and daily nutrient requirements
        if (sex === "male") {
            //Calculating activity coeficient and required daily calories
            switch (lifestyle) {
                case "sedentary":
                    activity = 1;
                    break;
                case "littleActive":
                    activity = 1.11;
                    break;
                case "active":
                    activity = 1.25;
                    break;
                case "veryActive":
                    activity = 1.48;
                    break;
            }

            reqCalories = 662 - (9.53 * age) + activity * ( (15.91 * weight) + (539.6 * height / 100) );

            //Asigning age specific nutrient requirements for male users
            if (18 <= age <= 30) {
                userNutReq = USERS_NUTRIENT_REQUIRMENTS["maleReq18"];
            }
            else if (31 <= age <= 50) {
                userNutReq = USERS_NUTRIENT_REQUIRMENTS["maleReq31"];
            }
            else if (51 <= age <= 70) {
                userNutReq = USERS_NUTRIENT_REQUIRMENTS["maleReq51"];
            }
            else if (age >= 71) {
                userNutReq = USERS_NUTRIENT_REQUIRMENTS["maleReq71"];
            }
        }

        else if (sex === "female") {
            //Calculating activity coeficient and required daily calories
            switch (lifestyle) {
                case "sedentary":
                    activity = 1;
                    break;
                case "littleActive":
                    activity = 1.12;
                    break;
                case "active":
                    activity = 1.27;
                    break;
                case "veryActive":
                    activity = 1.45;
                    break;
            }

            reqCalories = 354 - (6.91 * age) + activity * ( (9.36 * weight) + (726 * height / 100) );
                               
            //Calculating calories & nutrient requirements when the user is pregnant or lactating
            if (pregnantOrLactating !== "") {
                switch (pregnantOrLactating) {
                    case "pregnant2":
                        reqCalories += 340;
                        break;
                    case "pregnant3":
                        reqCalories += 452;
                        break;
                    case "lactating1":
                        reqCalories += 330;
                        break;
                    case "lactating2":
                        reqCalories += 400;
                        break;
                }

                switch (pregnantOrLactating) {
                    case "pregnant1":
                    case "pregnant2":
                    case "pregnant3":
                        userNutReq = USERS_NUTRIENT_REQUIRMENTS["femalePregnant"];
                        break;
                    case "lactating1":
                    case "lactating2":
                        userNutReq = USERS_NUTRIENT_REQUIRMENTS["femaleLactating"];
                        break;
                }
            }
            else {
                //Asigning age specific nutrient requirements for female users
                if (18 <= age <= 30) {
                    userNutReq = USERS_NUTRIENT_REQUIRMENTS["femaleReq18"];
                }
                else if (31 <= age <= 50) {
                    userNutReq = USERS_NUTRIENT_REQUIRMENTS["femaleReq31"];
                }
                else if (51 <= age <= 70) {
                    userNutReq = USERS_NUTRIENT_REQUIRMENTS["femaleReq51"];
                }
                else if (age >= 71) {
                    userNutReq = USERS_NUTRIENT_REQUIRMENTS["femaleReq71"];
                }
            }                   
        }

        //Adding calories property to user's object with nutrient requrements
        userNutReq["reqCalories"] = reqCalories.toFixed(0);
        
        //Filling the table "Daily Requirement"
        let tableReq = document.getElementById("tableDailyRequirement");
        let cellReqId = "";

        for (let rowIndex = 0; rowIndex < tableReq.rows.length; rowIndex++) {
            if (rowIndex == 6 || rowIndex == 19) {
            }
            else {
                cellReqId = tableReq.rows.item(rowIndex).cells[1].id;
                tableReq.rows.item(rowIndex).cells[1].innerHTML = userNutReq[cellReqId];
            }
        }
    }

    const axios = require('axios');


// Send a POST request to the /store_nutrients endpoint
axios.post('http://localhost:3000/store_nutrients',userNutReq )
  .then(response => {
    console.log(response.data);
  })
  .catch(error => {
    console.error(error);
  });
    
    
}

//Moving to divFoodSelection
// function checkMyDay() {
   

//         //Adding calories property to user's object with nutrient requrements
//         userNutReq["reqCalories"] = reqCalories.toFixed(0);
        
//         //Filling the table "Daily Requirement"
//         let tableReq = document.getElementById("tableDailyRequirement");
//         let cellReqId = "";

//         for (let rowIndex = 0; rowIndex < tableReq.rows.length; rowIndex++) {
//             if (rowIndex == 6 || rowIndex == 19) {
//             }
//             else {
//                 cellReqId = tableReq.rows.item(rowIndex).cells[1].id;
//                 tableReq.rows.item(rowIndex).cells[1].innerHTML = userNutReq[cellReqId];
                
//             }
//         }

// const axios = require('axios');


// // Send a POST request to the /store_nutrients endpoint
// axios.post('http://localhost:3000/store_nutrients', userNutReq)
//   .then(response => {
//     console.log(response.data);
//   })
//   .catch(error => {
//     console.error(error);
//   });
// }
